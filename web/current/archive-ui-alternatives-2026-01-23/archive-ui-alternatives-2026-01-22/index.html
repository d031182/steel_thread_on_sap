<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Products - SAP Fiori</title>
    <link href="https://fonts.googleapis.com/css2?family=72:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/themes.css">
    <style>
        /* SAP Fiori Horizon Theme */
        :root {
            --sapPositiveColor: #107e3e;
            --sapNegativeColor: #bb0000;
            --sapCriticalColor: #e9730c;
            --sapInformationColor: #0a6ed1;
            --sapNeutralColor: #6a6d70;
            --sapBackgroundColor: #f5f6f7;
            --sapBaseColor: #ffffff;
            --sapShellColor: #354a5f;
            --sapTextColor: #32363a;
            --sapLinkColor: #0a6ed1;
            --sapTitleColor: #32363a;
            --sapButton_Primary_Background: #0070f2;
            --sapButton_Primary_TextColor: #ffffff;
            --sapButton_Primary_Hover_Background: #0064d9;
            --sapContent_MarginSize: 1rem;
            --sapFontFamily: '72', '72full', Arial, Helvetica, sans-serif;
            --sapFontSize: 0.875rem;
            --sapField_BorderColor: #89919a;
            --sapField_Focus_BorderColor: #0070f2;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--sapFontFamily);
            font-size: var(--sapFontSize);
            background-color: var(--sapBackgroundColor);
            color: var(--sapTextColor);
            line-height: 1.5;
        }

        /* Shell Bar */
        .sapShellBar {
            background-color: var(--sapShellColor);
            color: white;
            padding: 0.75rem 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 1rem;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .sapShellBar .backButton {
            background: none;
            border: none;
            color: white;
            font-size: 1.25rem;
            cursor: pointer;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            transition: background-color 0.2s;
        }

        .sapShellBar .backButton:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .sapShellBar .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .sapShellBar .logo svg {
            height: 32px;
            width: auto;
        }

        .sapShellBar .title {
            flex: 1;
            font-size: 1rem;
            font-weight: 400;
        }

        .sapShellIconButton {
            background: none;
            border: none;
            color: white;
            font-size: 1.25rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.25rem;
        }

        .sapShellIconButton:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* Shell Navigation */
        .sapShellNav {
            display: flex;
            gap: 0.25rem;
            margin-left: 1rem;
        }

        .sapShellNavItem {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-family: var(--sapFontFamily);
            font-size: 0.875rem;
            cursor: pointer;
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .sapShellNavItem:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .sapShellNavItem.active {
            background-color: rgba(255, 255, 255, 0.15);
            color: white;
            font-weight: 700;
        }

        /* Container */
        .sapContainer {
            max-width: 1440px;
            margin: 0 auto;
            padding: var(--sapContent_MarginSize);
        }

        /* Page */
        .sapPage {
            display: none;
        }

        .sapPage.active {
            display: block;
        }

        /* List Report */
        .sapListReport {
            background-color: var(--sapBaseColor);
            border-radius: 0.25rem;
            box-shadow: 0 0 0.125rem 0 rgba(0,0,0,0.1);
            padding: 1.5rem;
        }

        .pageTitle {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .pageSubtitle {
            font-size: 0.875rem;
            color: var(--sapNeutralColor);
            margin-bottom: 2rem;
        }

        /* Data Product Cards Grid */
        .dataProductsGrid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .dataProductCard {
            background-color: var(--sapBaseColor);
            border: 1px solid #e5e5e5;
            border-radius: 0.25rem;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 0 0.125rem 0 rgba(0,0,0,0.1);
        }

        .dataProductCard:hover {
            box-shadow: 0 0 0.5rem 0 rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }

        .dataProductCard .icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .dataProductCard h3 {
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
        }

        .dataProductCard .description {
            font-size: 0.875rem;
            color: var(--sapNeutralColor);
            margin-bottom: 1rem;
            line-height: 1.5;
            min-height: 3rem;
        }

        .dataProductCard .metadata {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        /* Object Status */
        .sapObjectStatus {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .sapStatusSuccess {
            background-color: rgba(16, 126, 62, 0.1);
            color: var(--sapPositiveColor);
        }

        .sapStatusInfo {
            background-color: rgba(10, 110, 209, 0.1);
            color: var(--sapInformationColor);
        }

        .sapStatusWarning {
            background-color: rgba(233, 115, 12, 0.1);
            color: var(--sapCriticalColor);
        }

        .sapStatusError {
            background-color: rgba(187, 0, 0, 0.1);
            color: var(--sapNegativeColor);
        }

        .sapStatusNeutral {
            background-color: rgba(106, 109, 112, 0.1);
            color: var(--sapNeutralColor);
        }

        /* Object Page */
        .sapObjectPage {
            background-color: var(--sapBaseColor);
            border-radius: 0.25rem;
            box-shadow: 0 0 0.125rem 0 rgba(0,0,0,0.1);
        }

        .objectPageHeader {
            padding: 2rem;
            border-bottom: 1px solid #e5e5e5;
        }

        .objectPageHeader .icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .objectPageHeader h2 {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .objectPageHeader .subtitle {
            font-size: 1rem;
            color: var(--sapNeutralColor);
            margin-bottom: 1.5rem;
        }

        .objectPageContent {
            padding: 2rem;
        }

        .sectionTitle {
            font-size: 1.25rem;
            font-weight: 700;
            margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e5e5e5;
        }

        .sectionTitle:first-child {
            margin-top: 0;
        }

        /* Table List */
        .tablesList {
            display: grid;
            gap: 1.5rem;
        }

        .tableCard {
            background-color: var(--sapBackgroundColor);
            border: 1px solid #e5e5e5;
            border-radius: 0.25rem;
            padding: 1.5rem;
        }

        .tableCard h4 {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tableCard .tableStructure {
            margin-bottom: 1.5rem;
        }

        .tableCard .structureLabel {
            font-size: 0.875rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--sapNeutralColor);
        }

        .tableCard .fieldsList {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .fieldBadge {
            background-color: var(--sapBaseColor);
            border: 1px solid #e5e5e5;
            padding: 0.375rem 0.75rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-family: 'Courier New', monospace;
        }

        /* Sample Data Table */
        .sapTable {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 0.875rem;
            margin-top: 1rem;
            border: 1px solid #e5e5e5;
            border-radius: 0.25rem;
            overflow: hidden;
        }

        .sapTable thead {
            background-color: var(--sapBackgroundColor);
        }

        .sapTable th {
            padding: 0.75rem;
            text-align: left;
            font-weight: 700;
            border-bottom: 2px solid #e5e5e5;
            font-size: 0.75rem;
            text-transform: uppercase;
        }

        .sapTable td {
            padding: 0.75rem;
            border-bottom: 1px solid #e5e5e5;
        }

        .sapTable tbody tr:last-child td {
            border-bottom: none;
        }

        .sapTable tbody tr:hover {
            background-color: rgba(0, 112, 242, 0.03);
        }

        /* Buttons */
        .sapButton {
            font-family: var(--sapFontFamily);
            font-size: 0.875rem;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.25rem;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 400;
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
        }

        .sapButtonEmphasized {
            background-color: var(--sapButton_Primary_Background);
            color: var(--sapButton_Primary_TextColor);
        }

        .sapButtonEmphasized:hover {
            background-color: var(--sapButton_Primary_Hover_Background);
            transform: translateY(-1px);
        }

        .sapButtonDefault {
            background-color: transparent;
            color: var(--sapButton_Primary_Background);
            border: 1px solid var(--sapButton_Primary_Background);
        }

        .sapButtonDefault:hover {
            background-color: rgba(0, 112, 242, 0.05);
        }

        .sapButtonTransparent {
            background-color: transparent;
            color: var(--sapTextColor);
        }

        .sapButtonTransparent:hover {
            background-color: var(--sapBackgroundColor);
        }

        .sapButtonPositive {
            background-color: var(--sapPositiveColor);
            color: white;
        }

        .sapButtonPositive:hover {
            background-color: #0c6b33;
        }

        .sapButtonNegative {
            background-color: var(--sapNegativeColor);
            color: white;
        }

        .sapButtonNegative:hover {
            background-color: #a00000;
        }

        /* Forms */
        .sapFormGroup {
            margin-bottom: 1.5rem;
        }

        .sapFormLabel {
            display: block;
            font-size: 0.875rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--sapTextColor);
        }

        .sapInput {
            width: 100%;
            font-family: var(--sapFontFamily);
            font-size: 0.875rem;
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--sapField_BorderColor);
            border-radius: 0.25rem;
            background-color: var(--sapBaseColor);
            color: var(--sapTextColor);
            transition: border-color 0.2s;
        }

        .sapInput:focus {
            outline: none;
            border-color: var(--sapField_Focus_BorderColor);
            box-shadow: 0 0 0 1px var(--sapField_Focus_BorderColor);
        }

        .sapInput:disabled {
            background-color: var(--sapBackgroundColor);
            color: var(--sapNeutralColor);
            cursor: not-allowed;
        }

        .sapTextarea {
            width: 100%;
            font-family: 'Courier New', Consolas, monospace;
            font-size: 0.875rem;
            padding: 0.75rem;
            border: 1px solid var(--sapField_BorderColor);
            border-radius: 0.25rem;
            background-color: var(--sapBaseColor);
            color: var(--sapTextColor);
            resize: vertical;
            min-height: 300px;
            transition: border-color 0.2s;
        }

        .sapTextarea:focus {
            outline: none;
            border-color: var(--sapField_Focus_BorderColor);
            box-shadow: 0 0 0 1px var(--sapField_Focus_BorderColor);
        }

        /* Toast */
        .sapToast {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background-color: #32363a;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.25rem;
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.3);
            z-index: 3000;
            display: none;
            align-items: center;
            gap: 0.75rem;
        }

        .sapToast.active {
            display: flex;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                transform: translateX(-50%) translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }

        /* Modal Dialog */
        .sapDialog {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .sapDialog.active {
            display: flex;
        }

        .sapDialogContent {
            background-color: var(--sapBaseColor);
            border-radius: 0.25rem;
            box-shadow: 0 1rem 3rem rgba(0, 0, 0, 0.3);
            max-width: 90%;
            max-height: 90%;
            display: flex;
            flex-direction: column;
            animation: dialogSlideIn 0.3s ease-out;
        }

        @keyframes dialogSlideIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .sapDialogHeader {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e5e5e5;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sapDialogHeader h3 {
            font-size: 1.125rem;
            font-weight: 700;
            margin: 0;
        }

        .sapDialogCloseButton {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--sapNeutralColor);
            padding: 0.25rem;
            border-radius: 0.25rem;
            transition: background-color 0.2s;
        }

        .sapDialogCloseButton:hover {
            background-color: var(--sapBackgroundColor);
        }

        .sapDialogBody {
            padding: 1.5rem;
            overflow-y: auto;
            flex: 1;
        }

        .sapDialogFooter {
            padding: 1rem 1.5rem;
            border-top: 1px solid #e5e5e5;
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
        }

        /* CSN Viewer */
        .csnViewer {
            background-color: #1e1e1e;
            border-radius: 0.25rem;
            padding: 1rem;
            overflow-x: auto;
            font-family: 'Courier New', Consolas, monospace;
            font-size: 0.75rem;
            line-height: 1.5;
            max-height: 60vh;
        }

        .csnViewer pre {
            margin: 0;
            color: #d4d4d4;
        }

        .csnLoadingMessage {
            text-align: center;
            padding: 2rem;
            color: var(--sapNeutralColor);
        }

        .csnErrorMessage {
            text-align: center;
            padding: 2rem;
            color: var(--sapNegativeColor);
        }

        /* Action Bar in Object Page Header */
        .objectPageActions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        /* HANA Connection Page Styles */
        .hanaConnectionLayout {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 1.5rem;
            height: calc(100vh - 120px);
        }

        .instancesPanel {
            background-color: var(--sapBaseColor);
            border-radius: 0.25rem;
            box-shadow: 0 0 0.125rem 0 rgba(0,0,0,0.1);
            padding: 1.5rem;
            overflow-y: auto;
        }

        .sqlConsolePanel {
            background-color: var(--sapBaseColor);
            border-radius: 0.25rem;
            box-shadow: 0 0 0.125rem 0 rgba(0,0,0,0.1);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .instanceCard {
            background-color: var(--sapBackgroundColor);
            border: 2px solid #e5e5e5;
            border-radius: 0.25rem;
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .instanceCard:hover {
            border-color: var(--sapButton_Primary_Background);
            box-shadow: 0 0 0.25rem 0 rgba(0,0,0,0.1);
        }

        .instanceCard.selected {
            border-color: var(--sapButton_Primary_Background);
            background-color: rgba(0, 112, 242, 0.05);
        }

        .instanceCardHeader {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .instanceName {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }

        .instanceDetails {
            font-size: 0.75rem;
            color: var(--sapNeutralColor);
            margin-bottom: 0.5rem;
        }

        .instanceActions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .queryTemplates {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .templateButton {
            font-size: 0.75rem;
            padding: 0.375rem 0.75rem;
            background-color: var(--sapBackgroundColor);
            border: 1px solid #e5e5e5;
            border-radius: 0.25rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .templateButton:hover {
            background-color: #e5e5e5;
            border-color: var(--sapButton_Primary_Background);
        }

        .sqlResults {
            flex: 1;
            background-color: var(--sapBackgroundColor);
            border: 1px solid #e5e5e5;
            border-radius: 0.25rem;
            padding: 1rem;
            overflow: auto;
            font-family: 'Courier New', Consolas, monospace;
            font-size: 0.75rem;
        }

        .commandDisplay {
            background-color: #1e1e1e;
            color: #d4d4d4;
            padding: 1rem;
            border-radius: 0.25rem;
            font-family: 'Courier New', Consolas, monospace;
            font-size: 0.875rem;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .infoMessage {
            background-color: rgba(10, 110, 209, 0.1);
            border-left: 4px solid var(--sapInformationColor);
            padding: 1rem;
            border-radius: 0.25rem;
            margin-bottom: 1rem;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .hanaConnectionLayout {
                grid-template-columns: 1fr;
                height: auto;
            }

            .instancesPanel {
                max-height: 400px;
            }
        }

        @media (max-width: 768px) {
            .dataProductsGrid {
                grid-template-columns: 1fr;
            }
            
            .sapDialogContent {
                max-width: 95%;
                max-height: 95%;
            }

            .sapShellNav {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Shell Bar -->
    <div class="sapShellBar">
        <button class="backButton" id="backButton" onclick="navigateBack()" title="Back" style="display: none;">
            ‚Üê 
        </button>
        <div class="logo" onclick="navigateHome()" title="Home">
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 412.4 204" style="enable-background:new 0 0 412.4 204;" xml:space="preserve">
                <defs>
                    <linearGradient id="sapLogoGradient" gradientUnits="userSpaceOnUse" x1="206.19" y1="206" x2="206.19" y2="2" gradientTransform="matrix(1 0 0 -1 0 206)">
                        <stop offset="0" style="stop-color:#00B8F1"/>
                        <stop offset="0.02" style="stop-color:#01B6F0"/>
                        <stop offset="0.31" style="stop-color:#0D90D9"/>
                        <stop offset="0.58" style="stop-color:#1775C8"/>
                        <stop offset="0.82" style="stop-color:#1C65BF"/>
                        <stop offset="1" style="stop-color:#1E5FBB"/>
                    </linearGradient>
                </defs>
                <g>
                    <polyline style="fill-rule:evenodd;clip-rule:evenodd;fill:url(#sapLogoGradient);" points="0,204 208.4,204 412.4,0 0,0 0,204"/>
                    <path style="fill-rule:evenodd;clip-rule:evenodd;fill:#FFFFFF;" d="M244.7,38.4h-40.6v96.5l-35.5-96.6h-35.2l-30.3,80.7C100,98.7,79,91.7,62.4,86.4C51.5,82.9,39.8,77.7,40,72
                        c0.1-4.7,6.2-9,18.4-8.4c8.2,0.4,15.4,1.1,29.7,8l14.1-24.5c-13.1-6.6-31.2-10.9-46-10.9h-0.1c-17.3,0-31.7,5.6-40.6,14.8
                        c-6.2,6.3-9.7,14.8-9.7,23.7C5.5,87.2,10.1,96,19.7,103c8.1,5.9,18.5,9.8,27.6,12.6c11.3,3.5,20.5,6.5,20.4,13
                        c-0.1,2.4-1,4.7-2.7,6.4c-2.8,2.9-7.1,4-13.1,4.1c-11.5,0.2-20-1.6-33.6-9.6L5.8,154.4c14,8,29.9,12.2,46,12.2h2.1
                        c14.2-0.2,25.7-4.3,34.9-11.7c0.5-0.4,1-0.8,1.5-1.3l-4.1,10.9H123l6.2-18.8c7,2.3,14.3,3.5,21.7,3.4c7.2,0,14.3-1.1,21.2-3.2
                        l6,18.6h60.1v-39h13.1c31.7,0,50.5-16.2,50.5-43.2C301.7,52.2,283.5,38.4,244.7,38.4z M150.9,121c-4.4,0-8.8-0.7-13-2.3l12.9-40.6
                        h0.2l12.6,40.7C159.6,120.3,155.2,121,150.9,121z M247.1,97.7h-8.9V64.9h8.9c11.9,0,21.4,4,21.4,16.1
                        C268.5,93.7,259,97.6,247.1,97.7"/>
                </g>
            </svg>
        </div>
        <div class="title" id="shellTitle">Data Products</div>

        <!-- Shell Navigation -->
        <nav class="sapShellNav">
            <button class="sapShellNavItem active" id="navDataProducts" onclick="navigateToSection('dataProducts')">
                üì¶ Data Products
            </button>
            <button class="sapShellNavItem" id="navDataProductsExplorer" onclick="navigateToSection('dataProductsExplorer')">
                üóÑÔ∏è Explorer
            </button>
            <button class="sapShellNavItem" id="navHanaConnection" onclick="navigateToSection('hanaConnection')">
                üîå HANA Connection
            </button>
            <button class="sapShellNavItem" id="navLogs" onclick="navigateToSection('logs')">
                üìã Logs
            </button>
        </nav>

        <div style="display: flex; gap: 0.5rem; margin-left: auto; align-items: center;">
            <div class="themeSwitcher">
                <button id="themeSwitcherButton" class="themeSwitcherButton" onclick="window.themeManager?.toggleTheme()" title="Switch Theme">
                    <span class="themeIcon">üé®</span>
                    <span class="themeLabel">Custom</span>
                </button>
            </div>
            <button class="sapShellIconButton" title="Notifications">üîî</button>
            <button class="sapShellIconButton" title="Settings">‚öôÔ∏è</button>
            <button class="sapShellIconButton" title="User Menu">üë§</button>
        </div>
    </div>

    <!-- Main Container -->
    <div class="sapContainer">
        <!-- List Report Page (Entry Point) -->
        <div class="sapPage active" id="listReportPage">
            <div class="sapListReport">
                <h1 class="pageTitle">Data Products Catalog</h1>
                <p class="pageSubtitle">Browse and explore P2P data products with sample data</p>

                <div class="dataProductsGrid" id="dataProductsGrid">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Object Page (Detail View) -->
        <div class="sapPage" id="objectPage">
            <div class="sapObjectPage">
                <div class="objectPageHeader" id="objectPageHeader">
                    <!-- Populated by JavaScript -->
                </div>
                <div class="objectPageContent" id="objectPageContent">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Data Products Explorer Page -->
        <div class="sapPage" id="dataProductsExplorerPage">
            <div class="hanaConnectionLayout">
                <!-- Left Panel: Data Products List -->
                <div class="instancesPanel">
                    <h2 class="pageTitle" style="font-size: 1.25rem; margin-bottom: 0.5rem;">Installed Data Products</h2>
                    <p class="pageSubtitle" style="margin-bottom: 1rem;">Real data from HANA Cloud</p>

                    <div class="infoMessage" style="margin-bottom: 1rem;">
                        <strong>üóÑÔ∏è Live Data</strong><br>
                        <span style="font-size: 0.75rem;">Connected to your HANA instance via backend</span>
                    </div>

                    <div style="margin-bottom: 1rem;">
                        <input type="text" id="dpSearchInput" class="sapInput" placeholder="üîç Search data products..." 
                               oninput="filterDataProducts()" style="font-size: 0.75rem;">
                    </div>

                    <div id="dataProductsList" style="overflow-y: auto; max-height: calc(100vh - 300px);">
                        <div style="text-align: center; padding: 2rem; color: var(--sapNeutralColor);">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚è≥</div>
                            <div>Loading data products...</div>
                        </div>
                    </div>

                    <button class="sapButton sapButtonDefault" onclick="refreshDataProducts()" style="width: 100%; margin-top: 1rem;">
                        üîÑ Refresh
                    </button>
                </div>

                <!-- Right Panel: Data Product Details -->
                <div class="sqlConsolePanel">
                    <div id="explorerContent">
                        <div style="text-align: center; padding: 4rem; color: var(--sapNeutralColor);">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">üóÑÔ∏è</div>
                            <h3 style="font-size: 1.25rem; margin-bottom: 0.5rem;">Data Products Explorer</h3>
                            <p>Select a data product from the list to explore its tables and data</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logs Page -->
        <div class="sapPage" id="logsPage">
            <div class="sapListReport">
                <h1 class="pageTitle">Application Logs</h1>
                <p class="pageSubtitle">Monitor Flask backend activity and debugging information</p>

                <!-- Log Statistics -->
                <div id="logStats" style="margin-bottom: 1.5rem;">
                    <!-- Populated by JavaScript -->
                </div>

                <!-- Log Controls -->
                <div style="display: flex; gap: 0.5rem; margin-bottom: 1.5rem; flex-wrap: wrap;">
                    <button class="sapButton sapButtonEmphasized" id="autoRefreshBtn" onclick="window.toggleAutoRefresh()">
                        ‚ñ∂Ô∏è Start Auto-Refresh
                    </button>
                    <button class="sapButton sapButtonDefault" onclick="window.refreshLogs()">
                        üîÑ Refresh Now
                    </button>
                    <button class="sapButton sapButtonDefault" onclick="window.filterLogs('ALL')">
                        üìã All Logs
                    </button>
                    <button class="sapButton sapButtonDefault" onclick="window.filterLogs('INFO')">
                        ‚ÑπÔ∏è Info Only
                    </button>
                    <button class="sapButton sapButtonDefault" onclick="window.filterLogs('WARNING')">
                        ‚ö†Ô∏è Warnings Only
                    </button>
                    <button class="sapButton sapButtonDefault" onclick="window.filterLogs('ERROR')">
                        ‚ùå Errors Only
                    </button>
                    <button class="sapButton sapButtonNegative" onclick="window.clearAllLogs()" style="margin-left: auto;">
                        üóëÔ∏è Clear Logs
                    </button>
                </div>

                <!-- Logs Container -->
                <div id="logsContainer" style="background-color: var(--sapBaseColor); border: 1px solid #e5e5e5; border-radius: 0.25rem; padding: 1rem; min-height: 400px; overflow: auto;">
                    <div style="text-align: center; padding: 2rem; color: var(--sapNeutralColor);">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìã</div>
                        <div>Loading logs...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- HANA Connection Page -->
        <div class="sapPage" id="hanaConnectionPage">
            <div class="hanaConnectionLayout">
                <!-- Left Panel: Instances -->
                <div class="instancesPanel">
                    <h2 class="pageTitle" style="font-size: 1.25rem; margin-bottom: 0.5rem;">HANA Instances</h2>
                    <p class="pageSubtitle" style="margin-bottom: 1.5rem;">Manage your database connections</p>

                    <div id="instancesList">
                        <!-- Populated by JavaScript -->
                    </div>

                    <button class="sapButton sapButtonDefault" onclick="addInstance()" style="width: 100%;">
                        ‚ûï Add Instance
                    </button>
                </div>

                <!-- Right Panel: SQL Console -->
                <div class="sqlConsolePanel">
                    <h2 class="pageTitle" style="font-size: 1.25rem; margin-bottom: 0.5rem;">SQL Console</h2>
                    
                    <div class="infoMessage">
                        <strong>‚ÑπÔ∏è Browser Limitation</strong><br>
                        Direct database connections aren't possible from the browser. Use the commands below to execute SQL via hana-cli or Database Explorer.
                    </div>

                    <div class="queryTemplates">
                        <button class="templateButton" onclick="loadTemplate('check_user')">Check P2P_DP_USER</button>
                        <button class="templateButton" onclick="loadTemplate('list_schemas')">List Schemas</button>
                        <button class="templateButton" onclick="loadTemplate('list_tables')">List Tables</button>
                        <button class="templateButton" onclick="loadTemplate('check_privileges')">Check Privileges</button>
                        <button class="templateButton" onclick="loadTemplate('clear')">Clear</button>
                    </div>

                    <div class="sapFormGroup">
                        <label class="sapFormLabel">SQL Query</label>
                        <textarea id="sqlEditor" class="sapTextarea" placeholder="-- Enter your SQL query here&#10;SELECT * FROM SYS.USERS WHERE USER_NAME = 'P2P_DP_USER';"></textarea>
                    </div>

                    <div style="display: flex; gap: 0.5rem;">
                        <button class="sapButton sapButtonEmphasized" onclick="executeQueryInBrowser()" id="executeButton">
                            ‚ñ∂Ô∏è Execute Query
                        </button>
                        <button class="sapButton sapButtonDefault" onclick="executeSql()">
                            üìã Copy & Show CLI Command
                        </button>
                        <button class="sapButton sapButtonTransparent" onclick="openDatabaseExplorer()">
                            üåê Open Database Explorer
                        </button>
                        <button class="sapButton sapButtonTransparent" onclick="copyToClipboard()">
                            üìã Copy SQL Only
                        </button>
                    </div>

                    <div class="sapFormGroup">
                        <label class="sapFormLabel">Execution Instructions</label>
                        <div id="sqlResults" class="sqlResults">
                            <div style="color: var(--sapNeutralColor); padding: 2rem; text-align: center;">
                                Enter a query and click "Copy & Show Command" to see execution instructions
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="sapToast" id="toast">
        <span id="toastIcon">‚úì</span>
        <span id="toastMessage">Action completed</span>
    </div>

    <!-- CSN Dialog Modal -->
    <div class="sapDialog" id="csnDialog">
        <div class="sapDialogContent" style="width: 1000px;">
            <div class="sapDialogHeader">
                <h3 id="csnDialogTitle">CSN Definition</h3>
                <button class="sapDialogCloseButton" onclick="closeCsnDialog()" title="Close">√ó</button>
            </div>
            <div class="sapDialogBody" id="csnDialogBody">
                <!-- Content loaded dynamically -->
            </div>
            <div class="sapDialogFooter">
                <button class="sapButton sapButtonDefault" onclick="closeCsnDialog()">Close</button>
            </div>
        </div>
    </div>

    <!-- Instance Dialog Modal -->
    <div class="sapDialog" id="instanceDialog">
        <div class="sapDialogContent" style="width: 600px;">
            <div class="sapDialogHeader">
                <h3 id="instanceDialogTitle">Add HANA Instance</h3>
                <button class="sapDialogCloseButton" onclick="closeInstanceDialog()" title="Close">√ó</button>
            </div>
            <div class="sapDialogBody">
                <div class="sapFormGroup">
                    <label class="sapFormLabel">Instance Name *</label>
                    <input type="text" id="instanceName" class="sapInput" placeholder="e.g., BDC Production">
                </div>
                <div class="sapFormGroup">
                    <label class="sapFormLabel">Host *</label>
                    <input type="text" id="instanceHost" class="sapInput" placeholder="e.g., xxxxx.hana.prod-eu10.hanacloud.ondemand.com">
                </div>
                <div class="sapFormGroup">
                    <label class="sapFormLabel">Port *</label>
                    <input type="text" id="instancePort" class="sapInput" value="443">
                </div>
                <div class="sapFormGroup">
                    <label class="sapFormLabel">User *</label>
                    <input type="text" id="instanceUser" class="sapInput" placeholder="e.g., P2P_DP_USER">
                </div>
                <div class="sapFormGroup">
                    <label class="sapFormLabel">Schema</label>
                    <input type="text" id="instanceSchema" class="sapInput" placeholder="e.g., P2P_DATA_PRODUCTS">
                </div>
                <div class="sapFormGroup">
                    <label class="sapFormLabel">Description</label>
                    <input type="text" id="instanceDescription" class="sapInput" placeholder="Optional description">
                </div>
            </div>
            <div class="sapDialogFooter">
                <button class="sapButton sapButtonDefault" onclick="closeInstanceDialog()">Cancel</button>
                <button class="sapButton sapButtonEmphasized" onclick="saveInstance()">Save</button>
            </div>
        </div>
    </div>

    <script type="module">
        // Import APIs (following API-First principle from DEVELOPMENT_GUIDELINES.md)
        import { SQLExecutionAPI } from './js/api/sqlExecutionAPI.js';
        import { ResultFormatterAPI } from './js/api/resultFormatterAPI.js';
        import { HanaConnectionAPI } from './js/api/hanaConnectionAPI.js';
        import * as DataProductsExplorer from './js/ui/pages/dataProductsExplorer.js';
        import * as LogViewer from './js/ui/pages/logViewer.js';
        import { themeManager } from './js/utils/themeManager.js';

        // Initialize APIs
        const sqlExecutionAPI = new SQLExecutionAPI();
        const resultFormatterAPI = new ResultFormatterAPI();
        const hanaConnectionAPI = new HanaConnectionAPI();

        // Make APIs and Theme Manager available globally
        window.sqlExecutionAPI = sqlExecutionAPI;
        window.resultFormatterAPI = resultFormatterAPI;
        window.themeManager = themeManager;
        
        // Make Data Products Explorer functions globally available
        window.selectDataProduct = DataProductsExplorer.selectDataProduct;
        window.viewTableStructure = DataProductsExplorer.viewTableStructure;
        window.viewTableData = DataProductsExplorer.viewTableData;
        window.filterDataProducts = DataProductsExplorer.filterDataProducts;
        window.exportTableData = DataProductsExplorer.exportTableData;
        window.refreshDataProducts = () => DataProductsExplorer.refresh();
        window.viewCSNDefinition = DataProductsExplorer.viewCSNDefinition;
        window.closeCSNModal = DataProductsExplorer.closeCSNModal;
        window.downloadCSN = DataProductsExplorer.downloadCSN;
        window.copyCSN = DataProductsExplorer.copyCSN;

        // Make Log Viewer functions globally available
        window.refreshLogs = LogViewer.refreshLogs;
        window.filterLogs = LogViewer.filterLogs;
        window.clearAllLogs = LogViewer.clearAllLogs;
        window.toggleAutoRefresh = LogViewer.toggleAutoRefresh;

        // Data Products with detailed table information
        const dataProducts = {
            'Supplier': {
                icon: 'üì¶',
                title: 'Supplier',
                subtitle: 'Vendor Master Data',
                description: 'Vendor master data definition including contact information, banking details, and payment terms',
                type: 'Master Data',
                tables: [
                    {
                        name: 'Suppliers',
                        description: 'Main supplier master data table',
                        fields: ['SupplierID', 'SupplierName', 'Country', 'Currency', 'PaymentTermsCode', 'ContactPerson', 'Email', 'Phone', 'IsActive'],
                        sampleData: [
                            { SupplierID: 'SUP-001', SupplierName: 'Global Steel Supply Inc', Country: 'US', Currency: 'USD', PaymentTermsCode: 'NET30', ContactPerson: 'John Smith', Email: 'john@globalsteel.com', Phone: '+1-555-0100', IsActive: 'Yes' },
                            { SupplierID: 'SUP-002', SupplierName: 'Premium Electronics GmbH', Country: 'DE', Currency: 'EUR', PaymentTermsCode: '2/10NET30', ContactPerson: 'Anna Mueller', Email: 'anna@premium-elec.de', Phone: '+49-30-12345', IsActive: 'Yes' },
                            { SupplierID: 'SUP-005', SupplierName: 'Industrial Maintenance Services', Country: 'US', Currency: 'USD', PaymentTermsCode: 'NET60', ContactPerson: 'Mike Johnson', Email: 'mike@indmaint.com', Phone: '+1-555-0200', IsActive: 'Yes' }
                        ]
                    }
                ]
            },
            'PurchaseOrder': {
                icon: 'üìù',
                title: 'Purchase Order',
                subtitle: 'Procurement Documents',
                description: 'Purchase order header and item definitions with supplier confirmation tracking',
                type: 'Transaction',
                tables: [
                    {
                        name: 'PurchaseOrders',
                        description: 'Purchase order header data',
                        fields: ['PO_ID', 'SupplierID', 'OrderDate', 'TotalAmount', 'Currency', 'Status', 'CreatedBy'],
                        sampleData: [
                            { PO_ID: 'PO-2024001', SupplierID: 'SUP-001', OrderDate: '2024-01-10', TotalAmount: '5,250', Currency: 'USD', Status: 'Released', CreatedBy: 'USER001' },
                            { PO_ID: 'PO-2024002', SupplierID: 'SUP-005', OrderDate: '2024-01-15', TotalAmount: '10,500', Currency: 'USD', Status: 'Open', CreatedBy: 'USER002' },
                            { PO_ID: 'PO-2024003', SupplierID: 'SUP-002', OrderDate: '2024-01-20', TotalAmount: '15,488', Currency: 'EUR', Status: 'Partial', CreatedBy: 'USER001' }
                        ]
                    },
                    {
                        name: 'PurchaseOrderItems',
                        description: 'Purchase order line items',
                        fields: ['ItemID', 'PO_ID', 'MaterialID', 'Quantity', 'UnitPrice', 'TotalPrice', 'DeliveryDate'],
                        sampleData: [
                            { ItemID: 'ITEM-001', PO_ID: 'PO-2024001', MaterialID: 'MAT-001', Quantity: '50', UnitPrice: '105.00', TotalPrice: '5,250', DeliveryDate: '2024-02-10' },
                            { ItemID: 'ITEM-002', PO_ID: 'PO-2024002', MaterialID: 'SVC-001', Quantity: '100', UnitPrice: '105.00', TotalPrice: '10,500', DeliveryDate: '2024-02-15' }
                        ]
                    }
                ]
            },
            'ServiceEntry': {
                icon: 'üõ†Ô∏è',
                title: 'Service Entry Sheet',
                subtitle: 'Service Confirmations',
                description: 'Service confirmation documents with acceptance workflow',
                type: 'Transaction',
                tables: [
                    {
                        name: 'ServiceEntrySheets',
                        description: 'Service entry sheet headers',
                        fields: ['SES_ID', 'PO_ID', 'EntryDate', 'Status', 'TotalAmount', 'AcceptedBy', 'AcceptedDate'],
                        sampleData: [
                            { SES_ID: 'SES-2024001', PO_ID: 'PO-2024002', EntryDate: '2024-02-20', Status: 'Accepted', TotalAmount: '5,000 USD', AcceptedBy: 'MGR001', AcceptedDate: '2024-02-21' },
                            { SES_ID: 'SES-2024002', PO_ID: 'PO-2024004', EntryDate: '2024-03-18', Status: 'Accepted', TotalAmount: '2,550 USD', AcceptedBy: 'MGR002', AcceptedDate: '2024-03-19' }
                        ]
                    },
                    {
                        name: 'ServiceEntrySheetItems',
                        description: 'Service entry line items',
                        fields: ['ItemID', 'SES_ID', 'ServiceID', 'Quantity', 'UnitPrice', 'TotalPrice'],
                        sampleData: [
                            { ItemID: 'SES-ITEM-001', SES_ID: 'SES-2024001', ServiceID: 'SVC-001', Quantity: '50', UnitPrice: '100.00', TotalPrice: '5,000' },
                            { ItemID: 'SES-ITEM-002', SES_ID: 'SES-2024002', ServiceID: 'SVC-002', Quantity: '30', UnitPrice: '85.00', TotalPrice: '2,550' }
                        ]
                    }
                ]
            },
            'SupplierInvoice': {
                icon: 'üí∞',
                title: 'Supplier Invoice',
                subtitle: 'Accounts Payable Documents',
                description: 'Invoice header and item definitions with variance tracking and payment status',
                type: 'Transaction',
                tables: [
                    {
                        name: 'SupplierInvoices',
                        description: 'Supplier invoice headers',
                        fields: ['Invoice_ID', 'SupplierID', 'InvoiceDate', 'GrossAmount', 'Currency', 'InvoiceStatus', 'PaymentStatus', 'DueDate'],
                        sampleData: [
                            { Invoice_ID: 'INV-2024001', SupplierID: 'SUP-001', InvoiceDate: '2024-02-18', GrossAmount: '5,250', Currency: 'USD', InvoiceStatus: 'Posted', PaymentStatus: 'Paid', DueDate: '2024-03-20' },
                            { Invoice_ID: 'INV-2024002', SupplierID: 'SUP-005', InvoiceDate: '2024-02-22', GrossAmount: '5,250', Currency: 'USD', InvoiceStatus: 'Posted', PaymentStatus: 'Unpaid', DueDate: '2024-03-24' },
                            { Invoice_ID: 'INV-2024003', SupplierID: 'SUP-002', InvoiceDate: '2024-03-05', GrossAmount: '15,488', Currency: 'EUR', InvoiceStatus: 'Held', PaymentStatus: 'Blocked', DueDate: '2024-04-04' },
                            { Invoice_ID: 'INV-2024004', SupplierID: 'SUP-004', InvoiceDate: '2024-03-10', GrossAmount: '2,500', Currency: 'USD', InvoiceStatus: 'Posted', PaymentStatus: 'Unpaid', DueDate: '2024-04-09' },
                            { Invoice_ID: 'INV-2024005', SupplierID: 'SUP-005', InvoiceDate: '2024-03-12', GrossAmount: '890', Currency: 'USD', InvoiceStatus: 'Parked', PaymentStatus: 'Not Posted', DueDate: '2024-04-11' }
                        ]
                    },
                    {
                        name: 'SupplierInvoiceItems',
                        description: 'Invoice line items',
                        fields: ['ItemID', 'Invoice_ID', 'PO_ID', 'MaterialID', 'Quantity', 'UnitPrice', 'TotalPrice'],
                        sampleData: [
                            { ItemID: 'INV-ITEM-001', Invoice_ID: 'INV-2024001', PO_ID: 'PO-2024001', MaterialID: 'MAT-001', Quantity: '50', UnitPrice: '105.00', TotalPrice: '5,250' },
                            { ItemID: 'INV-ITEM-002', Invoice_ID: 'INV-2024002', PO_ID: 'PO-2024002', MaterialID: 'SVC-001', Quantity: '50', UnitPrice: '105.00', TotalPrice: '5,250' }
                        ]
                    }
                ]
            },
            'PaymentTerms': {
                icon: 'üìÖ',
                title: 'Payment Terms',
                subtitle: 'Payment Conditions',
                description: 'Payment terms master data with discount structures',
                type: 'Master Data',
                tables: [
                    {
                        name: 'PaymentTerms',
                        description: 'Payment terms definitions',
                        fields: ['Code', 'Name', 'NetPaymentDays', 'CashDiscount1Days', 'CashDiscount1Percent', 'CashDiscount2Days', 'CashDiscount2Percent'],
                        sampleData: [
                            { Code: 'NET30', Name: 'Net 30 Days', NetPaymentDays: '30', CashDiscount1Days: '-', CashDiscount1Percent: '-', CashDiscount2Days: '-', CashDiscount2Percent: '-' },
                            { Code: '2/10NET30', Name: '2% 10 Days Net 30', NetPaymentDays: '30', CashDiscount1Days: '10', CashDiscount1Percent: '2.0%', CashDiscount2Days: '-', CashDiscount2Percent: '-' },
                            { Code: 'NET60', Name: 'Net 60 Days', NetPaymentDays: '60', CashDiscount1Days: '-', CashDiscount1Percent: '-', CashDiscount2Days: '-', CashDiscount2Percent: '-' }
                        ]
                    }
                ]
            },
            'JournalEntry': {
                icon: 'üìä',
                title: 'Journal Entry Header',
                subtitle: 'Financial Accounting Documents',
                description: 'Financial accounting documents with GL postings for invoice posting and payment clearing',
                type: 'Transaction',
                tables: [
                    {
                        name: 'JournalEntries',
                        description: 'Journal entry headers',
                        fields: ['DocumentNumber', 'DocumentType', 'PostingDate', 'ReferenceDocument', 'Currency', 'CompanyCode', 'CreatedBy'],
                        sampleData: [
                            { DocumentNumber: '5000000001', DocumentType: 'KR', PostingDate: '2024-02-20', ReferenceDocument: 'INV-2024001', Currency: 'USD', CompanyCode: '1000', CreatedBy: 'USER001' },
                            { DocumentNumber: '5000000002', DocumentType: 'KZ', PostingDate: '2024-03-20', ReferenceDocument: 'PAY-2024001', Currency: 'USD', CompanyCode: '1000', CreatedBy: 'USER002' },
                            { DocumentNumber: '5000000004', DocumentType: 'KR', PostingDate: '2024-03-08', ReferenceDocument: 'INV-2024003', Currency: 'EUR', CompanyCode: '1000', CreatedBy: 'USER001' }
                        ]
                    },
                    {
                        name: 'JournalEntryItems',
                        description: 'Journal entry line items',
                        fields: ['ItemID', 'DocumentNumber', 'GLAccount', 'DebitAmount', 'CreditAmount', 'CostCenter'],
                        sampleData: [
                            { ItemID: '001', DocumentNumber: '5000000001', GLAccount: '160000', DebitAmount: '5,250', CreditAmount: '0', CostCenter: 'CC1000' },
                            { ItemID: '002', DocumentNumber: '5000000001', GLAccount: '211000', DebitAmount: '0', CreditAmount: '5,250', CostCenter: '-' }
                        ]
                    }
                ]
            }
        };

        // Mapping of data product keys to CSN file names
        const csnFileMapping = {
            'Supplier': '../../data-products/sap-s4com-Supplier-v1.en.json',
            'PurchaseOrder': '../../data-products/sap-s4com-PurchaseOrder-v1.en.json',
            'ServiceEntry': '../../data-products/sap-s4com-ServiceEntrySheet-v1.en.json',
            'SupplierInvoice': '../../data-products/sap-s4com-SupplierInvoice-v1.en-complete.json',
            'PaymentTerms': '../../data-products/sap-s4com-PaymentTerms-v1.en.json',
            'JournalEntry': '../../data-products/sap-s4com-JournalEntryHeader-v1.en.json'
        };

        // HANA Instances Management
        let hanaInstances = [];
        let selectedInstanceId = null;
        let editingInstanceId = null;

        // SQL Query Templates
        const sqlTemplates = {
            check_user: `-- Check if P2P_DP_USER exists
SELECT USER_NAME, CREATOR, CREATE_TIME, USER_DEACTIVATED
FROM SYS.USERS 
WHERE USER_NAME = 'P2P_DP_USER';`,
            
            list_schemas: `-- List all schemas
SELECT SCHEMA_NAME, SCHEMA_OWNER, CREATE_TIME
FROM SYS.SCHEMAS
ORDER BY SCHEMA_NAME;`,
            
            list_tables: `-- List tables in P2P_DATA_PRODUCTS schema
SELECT TABLE_NAME, TABLE_TYPE, RECORD_COUNT
FROM SYS.TABLES
WHERE SCHEMA_NAME = 'P2P_DATA_PRODUCTS'
ORDER BY TABLE_NAME;`,
            
            check_privileges: `-- Check P2P_DP_USER privileges
SELECT GRANTEE, PRIVILEGE, OBJECT_TYPE, IS_GRANTABLE
FROM SYS.GRANTED_PRIVILEGES
WHERE GRANTEE = 'P2P_DP_USER'
ORDER BY OBJECT_TYPE, PRIVILEGE;`
        };

        // Current navigation state
        let currentProduct = null;
        let currentSection = 'dataProducts';

        // Initialize application
        function init() {
            loadHanaInstances();
            renderDataProducts();
            renderInstances();
            showToast('üëã', 'Welcome to P2P Data Products Application');
        }

        // Navigation
        function navigateToSection(section) {
            currentSection = section;
            
            // Update nav buttons
            document.querySelectorAll('.sapShellNavItem').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Hide all pages
            document.querySelectorAll('.sapPage').forEach(page => {
                page.classList.remove('active');
            });
            
            if (section === 'dataProducts') {
                document.getElementById('navDataProducts').classList.add('active');
                document.getElementById('listReportPage').classList.add('active');
                document.getElementById('shellTitle').textContent = 'Data Products';
                document.getElementById('backButton').style.display = 'none';
            } else if (section === 'dataProductsExplorer') {
                document.getElementById('navDataProductsExplorer').classList.add('active');
                document.getElementById('dataProductsExplorerPage').classList.add('active');
                document.getElementById('shellTitle').textContent = 'Data Products Explorer';
                document.getElementById('backButton').style.display = 'none';
                // Initialize explorer on first visit
                if (!window.explorerInitialized) {
                    DataProductsExplorer.initializeExplorer();
                    window.explorerInitialized = true;
                }
            } else if (section === 'hanaConnection') {
                document.getElementById('navHanaConnection').classList.add('active');
                document.getElementById('hanaConnectionPage').classList.add('active');
                document.getElementById('shellTitle').textContent = 'HANA Connection';
                document.getElementById('backButton').style.display = 'none';
            } else if (section === 'logs') {
                document.getElementById('navLogs').classList.add('active');
                document.getElementById('logsPage').classList.add('active');
                document.getElementById('shellTitle').textContent = 'Application Logs';
                document.getElementById('backButton').style.display = 'none';
                // Initialize log viewer on first visit
                if (!window.logsInitialized) {
                    LogViewer.initializeLogViewer();
                    window.logsInitialized = true;
                }
            }
        }

        // HANA Instances Functions
        function loadHanaInstances() {
            const stored = localStorage.getItem('hanaInstances');
            if (stored) {
                hanaInstances = JSON.parse(stored);
            } else {
                // Create default instance
                hanaInstances = [{
                    id: 'instance-1',
                    name: 'BDC Production',
                    host: 'e7decab9-3e98-41cf-bbf7-d0a8c13d7fb9.hana.prod-eu10.hanacloud.ondemand.com',
                    port: '443',
                    user: 'P2P_DP_USER',
                    password: 'P2P_DataProd123!',
                    schema: 'P2P_DATA_PRODUCTS',
                    description: 'Data product consumption user',
                    isDefault: true,
                    ssl: true
                }];
                saveHanaInstances();
            }
            if (hanaInstances.length > 0 && !selectedInstanceId) {
                selectedInstanceId = hanaInstances[0].id;
            }
        }

        function saveHanaInstances() {
            localStorage.setItem('hanaInstances', JSON.stringify(hanaInstances));
        }

        function renderInstances() {
            const list = document.getElementById('instancesList');
            list.innerHTML = '';

            hanaInstances.forEach(instance => {
                const card = document.createElement('div');
                card.className = 'instanceCard' + (instance.id === selectedInstanceId ? ' selected' : '');
                card.onclick = () => selectInstance(instance.id);

                const statusIcon = instance.status === 'connected' ? 'üü¢' : 
                                  instance.status === 'error' ? 'üî¥' : 'üü°';

                card.innerHTML = `
                    <div class="instanceCardHeader">
                        <div>
                            <div class="instanceName">${statusIcon} ${instance.name}</div>
                            ${instance.isDefault ? '<span class="sapObjectStatus sapStatusInfo">DEFAULT</span>' : ''}
                        </div>
                    </div>
                    <div class="instanceDetails">
                        <div>üñ•Ô∏è ${instance.host}</div>
                        <div>üë§ ${instance.user}</div>
                        <div>üìä ${instance.schema || '(no schema)'}</div>
                    </div>
                    ${instance.description ? `<div style="font-size: 0.75rem; color: var(--sapNeutralColor); margin-top: 0.5rem;">${instance.description}</div>` : ''}
                    <div class="instanceActions">
                        <button class="sapButton sapButtonDefault" onclick="event.stopPropagation(); editInstance('${instance.id}')" style="font-size: 0.75rem; padding: 0.375rem 0.75rem;">
                            ‚úèÔ∏è Edit
                        </button>
                        <button class="sapButton sapButtonDefault" onclick="event.stopPropagation(); testConnection('${instance.id}')" style="font-size: 0.75rem; padding: 0.375rem 0.75rem;">
                            üîå Test
                        </button>
                        ${!instance.isDefault ? `<button class="sapButton sapButtonNegative" onclick="event.stopPropagation(); deleteInstance('${instance.id}')" style="font-size: 0.75rem; padding: 0.375rem 0.75rem;">
                            üóëÔ∏è
                        </button>` : ''}
                    </div>
                `;
                list.appendChild(card);
            });
        }

        function selectInstance(id) {
            selectedInstanceId = id;
            renderInstances();
            showToast('‚úì', 'Instance selected');
        }

        function addInstance() {
            editingInstanceId = null;
            document.getElementById('instanceDialogTitle').textContent = 'Add HANA Instance';
            document.getElementById('instanceName').value = '';
            document.getElementById('instanceHost').value = '';
            document.getElementById('instancePort').value = '443';
            document.getElementById('instanceUser').value = '';
            document.getElementById('instanceSchema').value = '';
            document.getElementById('instanceDescription').value = '';
            document.getElementById('instanceDialog').classList.add('active');
        }

        function editInstance(id) {
            editingInstanceId = id;
            const instance = hanaInstances.find(i => i.id === id);
            if (!instance) return;

            document.getElementById('instanceDialogTitle').textContent = 'Edit HANA Instance';
            document.getElementById('instanceName').value = instance.name;
            document.getElementById('instanceHost').value = instance.host;
            document.getElementById('instancePort').value = instance.port;
            document.getElementById('instanceUser').value = instance.user;
            document.getElementById('instanceSchema').value = instance.schema || '';
            document.getElementById('instanceDescription').value = instance.description || '';
            document.getElementById('instanceDialog').classList.add('active');
        }

        function saveInstance() {
            const name = document.getElementById('instanceName').value.trim();
            const host = document.getElementById('instanceHost').value.trim();
            const port = document.getElementById('instancePort').value.trim();
            const user = document.getElementById('instanceUser').value.trim();
            const schema = document.getElementById('instanceSchema').value.trim();
            const description = document.getElementById('instanceDescription').value.trim();

            if (!name || !host || !port || !user) {
                showToast('‚ö†Ô∏è', 'Please fill in all required fields');
                return;
            }

            if (editingInstanceId) {
                const instance = hanaInstances.find(i => i.id === editingInstanceId);
                if (instance) {
                    instance.name = name;
                    instance.host = host;
                    instance.port = port;
                    instance.user = user;
                    instance.schema = schema;
                    instance.description = description;
                }
            } else {
                hanaInstances.push({
                    id: 'instance-' + Date.now(),
                    name,
                    host,
                    port,
                    user,
                    schema,
                    description,
                    ssl: true,
                    isDefault: hanaInstances.length === 0
                });
            }

            saveHanaInstances();
            renderInstances();
            closeInstanceDialog();
            showToast('‚úì', editingInstanceId ? 'Instance updated' : 'Instance added');
        }

        function deleteInstance(id) {
            if (!confirm('Are you sure you want to delete this instance?')) return;
            
            hanaInstances = hanaInstances.filter(i => i.id !== id);
            if (selectedInstanceId === id) {
                selectedInstanceId = hanaInstances.length > 0 ? hanaInstances[0].id : null;
            }
            saveHanaInstances();
            renderInstances();
            showToast('‚úì', 'Instance deleted');
        }

        function testConnection(id) {
            const instance = hanaInstances.find(i => i.id === id);
            if (!instance) return;

            // Simulate connection test (browser can't actually connect)
            instance.status = 'testing';
            renderInstances();

            setTimeout(() => {
                instance.status = 'connected';
                renderInstances();
                showToast('‚úì', `Connection test successful for ${instance.name}`);
            }, 1500);
        }

        function closeInstanceDialog() {
            document.getElementById('instanceDialog').classList.remove('active');
            editingInstanceId = null;
        }

        // SQL Console Functions
        function loadTemplate(template) {
            if (template === 'clear') {
                document.getElementById('sqlEditor').value = '';
                document.getElementById('sqlResults').innerHTML = '<div style="color: var(--sapNeutralColor); padding: 2rem; text-align: center;">Enter a query and click "Copy & Show Command" to see execution instructions</div>';
            } else {
                document.getElementById('sqlEditor').value = sqlTemplates[template] || '';
            }
        }

        function executeSql() {
            const sql = document.getElementById('sqlEditor').value.trim();
            if (!sql) {
                showToast('‚ö†Ô∏è', 'Please enter a SQL query');
                return;
            }

            if (!selectedInstanceId) {
                showToast('‚ö†Ô∏è', 'Please select a HANA instance');
                return;
            }

            const instance = hanaInstances.find(i => i.id === selectedInstanceId);
            if (!instance) return;

            // Copy SQL to clipboard
            navigator.clipboard.writeText(sql).then(() => {
                showToast('üìã', 'SQL copied to clipboard');
            });

            // Show execution instructions
            const results = document.getElementById('sqlResults');
            results.innerHTML = `
                <div style="padding: 1rem;">
                    <h4 style="margin-bottom: 1rem; color: var(--sapInformationColor);">üìã SQL Query Copied!</h4>
                    
                    <p style="margin-bottom: 1rem;"><strong>Selected Instance:</strong> ${instance.name}</p>
                    
                    <h4 style="margin: 1.5rem 0 0.75rem 0;">Option 1: Database Explorer (Recommended)</h4>
                    <p style="margin-bottom: 0.5rem;">Open Database Explorer and paste the query:</p>
                    <div class="commandDisplay">hana-cli opendbx</div>
                    <p style="margin-top: 0.5rem; font-size: 0.75rem; color: var(--sapNeutralColor);">
                        Then: Ctrl+V to paste query ‚Üí F8 to execute
                    </p>

                    <h4 style="margin: 1.5rem 0 0.75rem 0;">Option 2: hana-cli Command</h4>
                    <p style="margin-bottom: 0.5rem;">Execute the query directly:</p>
                    <div class="commandDisplay">hana-cli querySimple -q "${sql.replace(/"/g, '\\"').replace(/\n/g, ' ')}"</div>
                    
                    <h4 style="margin: 1.5rem 0 0.75rem 0;">Connection Details</h4>
                    <div style="background-color: var(--sapBackgroundColor); padding: 0.75rem; border-radius: 0.25rem; font-family: monospace; font-size: 0.75rem;">
                        <div>Host: ${instance.host}</div>
                        <div>Port: ${instance.port}</div>
                        <div>User: ${instance.user}</div>
                        <div>Schema: ${instance.schema || '(default)'}</div>
                    </div>
                </div>
            `;
        }

        function openDatabaseExplorer() {
            if (!selectedInstanceId) {
                showToast('‚ö†Ô∏è', 'Please select a HANA instance');
                return;
            }

            showToast('üåê', 'Opening Database Explorer...');
            
            // Show instructions
            const results = document.getElementById('sqlResults');
            results.innerHTML = `
                <div style="padding: 1rem;">
                    <h4 style="margin-bottom: 1rem; color: var(--sapInformationColor);">üåê Opening Database Explorer</h4>
                    
                    <p style="margin-bottom: 0.5rem;"><strong>Command:</strong></p>
                    <div class="commandDisplay">hana-cli opendbx</div>
                    
                    <p style="margin-top: 1rem; font-size: 0.875rem;">
                        This will open the SAP HANA Database Explorer in your browser using the connection details from default-env.json
                    </p>
                    
                    <h4 style="margin: 1.5rem 0 0.75rem 0;">Next Steps:</h4>
                    <ol style="margin-left: 1.5rem; font-size: 0.875rem;">
                        <li>Wait for Database Explorer to load</li>
                        <li>Open SQL Console (Ctrl+Alt+C)</li>
                        <li>Paste your query (Ctrl+V)</li>
                        <li>Execute (F8)</li>
                    </ol>
                </div>
            `;
        }

        function copyToClipboard() {
            const sql = document.getElementById('sqlEditor').value.trim();
            if (!sql) {
                showToast('‚ö†Ô∏è', 'No SQL to copy');
                return;
            }

            navigator.clipboard.writeText(sql).then(() => {
                showToast('üìã', 'SQL copied to clipboard');
            }).catch(() => {
                showToast('‚ùå', 'Failed to copy SQL');
            });
        }

        // Data Products Functions (existing)
        async function openCsnDialog(productKey) {
            const product = dataProducts[productKey];
            const csnFile = csnFileMapping[productKey];
            
            if (!csnFile) {
                showToast('‚ö†Ô∏è', 'CSN file not available for this product');
                return;
            }

            document.getElementById('csnDialogTitle').textContent = `CSN Definition - ${product.title}`;
            
            const dialogBody = document.getElementById('csnDialogBody');
            dialogBody.innerHTML = '<div class="csnLoadingMessage">‚è≥ Loading CSN definition...</div>';
            document.getElementById('csnDialog').classList.add('active');

            try {
                const response = await fetch(csnFile);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const csnData = await response.json();
                
                const formattedJson = JSON.stringify(csnData, null, 2);
                dialogBody.innerHTML = `
                    <div class="csnViewer">
                        <pre>${escapeHtml(formattedJson)}</pre>
                    </div>
                `;
                
                showToast('‚úì', 'CSN definition loaded successfully');
            } catch (error) {
                console.error('Error loading CSN file:', error);
                dialogBody.innerHTML = `
                    <div class="csnErrorMessage">
                        ‚ùå Error loading CSN definition<br>
                        <small>File: ${csnFile}</small><br>
                        <small>${error.message}</small>
                    </div>
                `;
                showToast('‚ùå', 'Failed to load CSN definition');
            }
        }

        function closeCsnDialog() {
            document.getElementById('csnDialog').classList.remove('active');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        document.addEventListener('click', function(event) {
            const dialog = document.getElementById('csnDialog');
            if (event.target === dialog) {
                closeCsnDialog();
            }
            const instanceDialog = document.getElementById('instanceDialog');
            if (event.target === instanceDialog) {
                closeInstanceDialog();
            }
        });

        function renderDataProducts() {
            const grid = document.getElementById('dataProductsGrid');
            grid.innerHTML = '';

            Object.keys(dataProducts).forEach(key => {
                const product = dataProducts[key];
                const tablesCount = product.tables.length;
                const samplesCount = product.tables.reduce((sum, t) => sum + t.sampleData.length, 0);

                const card = document.createElement('div');
                card.className = 'dataProductCard';
                card.onclick = () => openDataProduct(key);
                card.innerHTML = `
                    <div class="icon">${product.icon}</div>
                    <h3>${product.title}</h3>
                    <div class="description">${product.description}</div>
                    <div class="metadata">
                        <span class="sapObjectStatus ${product.type === 'Master Data' ? 'sapStatusInfo' : 'sapStatusSuccess'}">
                            ${product.type}
                        </span>
                        <span class="sapObjectStatus sapStatusSuccess">
                            ${tablesCount} ${tablesCount === 1 ? 'Table' : 'Tables'}
                        </span>
                        <span class="sapObjectStatus sapStatusSuccess">
                            ${samplesCount} Samples
                        </span>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function openDataProduct(productKey) {
            currentProduct = productKey;
            const product = dataProducts[productKey];

            document.getElementById('backButton').style.display = 'block';
            document.getElementById('shellTitle').textContent = product.title;

            const header = document.getElementById('objectPageHeader');
            header.innerHTML = `
                <div class="icon">${product.icon}</div>
                <h2>${product.title}</h2>
                <div class="subtitle">${product.subtitle}</div>
                <div style="display: flex; gap: 0.5rem;">
                    <span class="sapObjectStatus ${product.type === 'Master Data' ? 'sapStatusInfo' : 'sapStatusSuccess'}">
                        ${product.type}
                    </span>
                    <span class="sapObjectStatus sapStatusSuccess">
                        ${product.tables.length} ${product.tables.length === 1 ? 'Table' : 'Tables'}
                    </span>
                </div>
                <div class="objectPageActions">
                    <button class="sapButton sapButtonEmphasized" onclick="openCsnDialog('${productKey}')">
                        üìÑ View CSN Definition
                    </button>
                    <button class="sapButton sapButtonDefault" onclick="navigateToSection('dataProductsExplorer')">
                        üóÑÔ∏è View Live Data
                    </button>
                </div>
            `;

            const content = document.getElementById('objectPageContent');
            content.innerHTML = `<h3 class="sectionTitle">Tables & Sample Data</h3>`;

            const tablesList = document.createElement('div');
            tablesList.className = 'tablesList';

            product.tables.forEach(table => {
                const tableCard = document.createElement('div');
                tableCard.className = 'tableCard';

                let tableHTML = `
                    <h4>
                        <span>üìã ${table.name}</span>
                        <span class="sapObjectStatus sapStatusSuccess">${table.sampleData.length} records</span>
                    </h4>
                    <p style="font-size: 0.875rem; color: var(--sapNeutralColor); margin-bottom: 1rem;">
                        ${table.description}
                    </p>
                `;

                tableHTML += `
                    <div class="tableStructure">
                        <div class="structureLabel">Table Structure (${table.fields.length} fields):</div>
                        <div class="fieldsList">
                            ${table.fields.map(f => `<span class="fieldBadge">${f}</span>`).join('')}
                        </div>
                    </div>
                `;

                tableHTML += `
                    <div class="structureLabel">Sample Data:</div>
                    <table class="sapTable">
                        <thead>
                            <tr>
                                ${table.fields.map(f => `<th>${f}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            ${table.sampleData.map(row => `
                                <tr>
                                    ${table.fields.map(f => `<td>${row[f]}</td>`).join('')}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;

                tableCard.innerHTML = tableHTML;
                tablesList.appendChild(tableCard);
            });

            content.appendChild(tablesList);

            document.getElementById('listReportPage').classList.remove('active');
            document.getElementById('objectPage').classList.add('active');

            showToast('üìÑ', `Viewing ${product.title} details`);
        }

        function navigateBack() {
            if (currentProduct) {
                currentProduct = null;
                document.getElementById('backButton').style.display = 'none';
                document.getElementById('shellTitle').textContent = 'Data Products';
                document.getElementById('objectPage').classList.remove('active');
                document.getElementById('listReportPage').classList.add('active');
                showToast('üìã', 'Back to Data Products Catalog');
            } else {
                navigateHome();
            }
        }

        function navigateHome() {
            showToast('üè†', 'Navigating to Launchpad...');
        }

        function showToast(icon, message) {
            const toast = document.getElementById('toast');
            document.getElementById('toastIcon').textContent = icon;
            document.getElementById('toastMessage').textContent = message;
            
            toast.classList.add('active');
            
            setTimeout(() => {
                toast.classList.remove('active');
            }, 3000);
        }

        /**
         * Execute SQL query in browser using SQL Execution API
         * Follows API-First principle from DEVELOPMENT_GUIDELINES.md
         */
        async function executeQueryInBrowser() {
            const sql = document.getElementById('sqlEditor').value.trim();
            if (!sql) {
                showToast('‚ö†Ô∏è', 'Please enter a SQL query');
                return;
            }

            if (!selectedInstanceId) {
                showToast('‚ö†Ô∏è', 'Please select a HANA instance');
                return;
            }

            const instance = hanaInstances.find(i => i.id === selectedInstanceId);
            if (!instance) {
                showToast('‚ùå', 'Instance not found');
                return;
            }

            // Show loading state
            const resultsDiv = document.getElementById('sqlResults');
            const executeButton = document.getElementById('executeButton');
            
            executeButton.disabled = true;
            executeButton.innerHTML = '‚è≥ Executing...';
            
            resultsDiv.innerHTML = '<div style="color: var(--sapNeutralColor); padding: 2rem; text-align: center;">‚è≥ Executing query...</div>';

            try {
                // Call SQL Execution API
                const result = await window.sqlExecutionAPI.executeQuery(selectedInstanceId, sql, {
                    maxRows: 100,
                    includeMetadata: true
                });

                // Format and display results using Result Formatter API
                if (result.success) {
                    displayQueryResults(result);
                    showToast('‚úì', `Query executed successfully in ${result.executionTime}ms`);
                } else {
                    displayQueryError(result);
                    showToast('‚ùå', 'Query execution failed');
                }

            } catch (error) {
                console.error('Execution error:', error);
                resultsDiv.innerHTML = `
                    <div style="padding: 1rem;">
                        <h4 style="color: var(--sapNegativeColor); margin-bottom: 1rem;">‚ùå Execution Error</h4>
                        <p>${escapeHtml(error.message)}</p>
                    </div>
                `;
                showToast('‚ùå', 'Execution error occurred');
            } finally {
                executeButton.disabled = false;
                executeButton.innerHTML = '‚ñ∂Ô∏è Execute Query';
            }
        }

        /**
         * Display query results in table format
         */
        function displayQueryResults(result) {
            const formatted = window.resultFormatterAPI.formatResults(result, 'table');
            const summary = window.resultFormatterAPI.formatSummary(result);
            const metadata = formatted.metadata;
            
            const resultsDiv = document.getElementById('sqlResults');
            
            let html = `
                <div style="padding: 1rem; font-family: var(--sapFontFamily);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid #e5e5e5;">
                        <h4 style="color: var(--sapPositiveColor); margin: 0;">‚úì ${summary}</h4>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <span class="sapObjectStatus sapStatusInfo">${metadata.queryType}</span>
                            <span class="sapObjectStatus sapStatusSuccess">${metadata.rowCount} rows</span>
                            <span class="sapObjectStatus sapStatusNeutral">${metadata.executionTime}</span>
                        </div>
                    </div>
            `;

            if (result.rowCount > 0 && formatted.data.length > 0) {
                html += '<div style="overflow-x: auto;"><table class="sapTable" style="margin-top: 0;">';
                
                // Table headers
                html += '<thead><tr>';
                formatted.headers.forEach(header => {
                    html += `<th>${escapeHtml(header.label)}</th>`;
                });
                html += '</tr></thead>';
                
                // Table data
                html += '<tbody>';
                formatted.data.forEach(row => {
                    html += '<tr>';
                    formatted.headers.forEach(header => {
                        const value = row[header.key];
                        html += `<td>${value !== null && value !== undefined ? escapeHtml(String(value)) : '<span style="color: var(--sapNeutralColor);">NULL</span>'}</td>`;
                    });
                    html += '</tr>';
                });
                html += '</tbody></table></div>';
            } else {
                html += '<div style="padding: 1rem; text-align: center; color: var(--sapNeutralColor);">No rows returned</div>';
            }

            html += '</div>';
            resultsDiv.innerHTML = html;
        }

        /**
         * Display query error
         */
        function displayQueryError(result) {
            const formattedError = window.resultFormatterAPI.formatError(result.error);
            
            const resultsDiv = document.getElementById('sqlResults');
            
            let html = `
                <div style="padding: 1rem;">
                    <h4 style="color: var(--sapNegativeColor); margin-bottom: 1rem;">‚ùå ${escapeHtml(formattedError.title)}</h4>
                    <div style="background-color: rgba(187, 0, 0, 0.05); border-left: 4px solid var(--sapNegativeColor); padding: 1rem; border-radius: 0.25rem; margin-bottom: 1rem;">
                        <p style="font-family: var(--sapFontFamily);"><strong>Error:</strong> ${escapeHtml(formattedError.message)}</p>
                        ${formattedError.code ? `<p style="font-family: monospace; font-size: 0.75rem; margin-top: 0.5rem; color: var(--sapNeutralColor);">Code: ${escapeHtml(formattedError.code)}</p>` : ''}
                    </div>
            `;

            if (formattedError.suggestions && formattedError.suggestions.length > 0) {
                html += '<div style="margin-top: 1rem;"><strong>üí° Suggestions:</strong><ul style="margin-left: 1.5rem; margin-top: 0.5rem; font-family: var(--sapFontFamily);">';
                formattedError.suggestions.forEach(suggestion => {
                    html += `<li>${escapeHtml(suggestion)}</li>`;
                });
                html += '</ul></div>';
            }

            html += `
                    <div style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid #e5e5e5; font-size: 0.75rem; color: var(--sapNeutralColor);">
                        <strong>Execution Time:</strong> ${result.executionTime}ms<br>
                        <strong>Timestamp:</strong> ${new Date(result.timestamp).toLocaleString()}
                    </div>
                </div>
            `;
            
            resultsDiv.innerHTML = html;
        }

        // Make functions available globally for inline onclick handlers
        window.navigateToSection = navigateToSection;
        window.navigateBack = navigateBack;
        window.navigateHome = navigateHome;
        window.selectInstance = selectInstance;
        window.addInstance = addInstance;
        window.editInstance = editInstance;
        window.saveInstance = saveInstance;
        window.deleteInstance = deleteInstance;
        window.testConnection = testConnection;
        window.closeInstanceDialog = closeInstanceDialog;
        window.loadTemplate = loadTemplate;
        window.executeSql = executeSql;
        window.executeQueryInBrowser = executeQueryInBrowser;
        window.openDatabaseExplorer = openDatabaseExplorer;
        window.copyToClipboard = copyToClipboard;
        window.openDataProduct = openDataProduct;
        window.openCsnDialog = openCsnDialog;
        window.closeCsnDialog = closeCsnDialog;
        window.escapeHtml = escapeHtml;
        window.showToast = showToast;

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
