<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage P2P Data Products - SAP Fiori</title>
    
    <!-- SAP UI5 Bootstrap -->
    <script
        id="sap-ui-bootstrap"
        src="https://sapui5.hana.ondemand.com/resources/sap-ui-core.js"
        data-sap-ui-theme="sap_horizon"
        data-sap-ui-libs="sap.m,sap.f,sap.uxap"
        data-sap-ui-compatVersion="edge"
        data-sap-ui-async="true"
        data-sap-ui-frameOptions="trusted"
        data-sap-ui-resourceroots='{
            "p2p.viewer": "./"
        }'>
    </script>
    
    <script>
        sap.ui.getCore().attachInit(function() {
            "use strict";
            
            sap.ui.require([
                "sap/f/FlexibleColumnLayout",
                "sap/f/library",
                "sap/m/App",
                "sap/m/Page",
                "sap/m/List",
                "sap/m/StandardListItem",
                "sap/m/ObjectListItem",
                "sap/m/ObjectStatus",
                "sap/m/ObjectNumber",
                "sap/m/ObjectAttribute",
                "sap/m/ObjectHeader",
                "sap/m/MessageStrip",
                "sap/m/VBox",
                "sap/m/HBox",
                "sap/m/Text",
                "sap/m/Title",
                "sap/m/Label",
                "sap/m/Button",
                "sap/m/Bar",
                "sap/m/ToolbarSpacer",
                "sap/m/GenericTile",
                "sap/m/TileContent",
                "sap/m/NumericContent",
                "sap/m/Panel",
                "sap/uxap/ObjectPageLayout",
                "sap/uxap/ObjectPageSection",
                "sap/uxap/ObjectPageSubSection",
                "sap/uxap/ObjectPageHeader",
                "sap/uxap/ObjectPageHeaderContent",
                "sap/uxap/ObjectPageHeaderActionButton",
                "sap/ui/layout/cssgrid/CSSGrid",
                "sap/ui/core/HTML"
            ], function(
                FlexibleColumnLayout, fioriLibrary, App, Page, List, StandardListItem,
                ObjectListItem, ObjectStatus, ObjectNumber, ObjectAttribute, ObjectHeader,
                MessageStrip, VBox, HBox, Text, Title, Label, Button, Bar, ToolbarSpacer,
                GenericTile, TileContent, NumericContent, Panel,
                ObjectPageLayout, ObjectPageSection, ObjectPageSubSection,
                ObjectPageHeader, ObjectPageHeaderContent, ObjectPageHeaderActionButton,
                CSSGrid, HTML
            ) {
                
                var LayoutType = fioriLibrary.LayoutType;
                
                // Data Products content
                var dataProducts = [
                    {
                        id: "supplier",
                        title: "Supplier",
                        subtitle: "Master Data Product",
                        description: "Vendor master data definition including contact information, banking details, and payment terms",
                        file: "sap-s4com-Supplier-v1.en.json",
                        type: "Master Data",
                        status: "Success",
                        artefacts: ["CSN Schema", "Entity Definitions", "i18n Translations"],
                        entities: ["Supplier", "SupplierCompany", "SupplierPurchasingOrg"]
                    },
                    {
                        id: "purchaseorder",
                        title: "Purchase Order",
                        subtitle: "Transaction Product",
                        description: "Purchase order header and item definitions with supplier confirmation tracking",
                        file: "sap-s4com-PurchaseOrder-v1.en.json",
                        type: "Transaction",
                        status: "Error",
                        artefacts: ["CSN Schema", "Entity Definitions", "i18n Translations", "Associations"],
                        entities: ["PurchaseOrder", "PurchaseOrderItem", "PurchaseOrderScheduleLine"]
                    },
                    {
                        id: "serviceentry",
                        title: "Service Entry Sheet",
                        subtitle: "Transaction Product",
                        description: "Service confirmation documents with acceptance workflow",
                        file: "sap-s4com-ServiceEntrySheet-v1.en.json",
                        type: "Transaction",
                        status: "Error",
                        artefacts: ["CSN Schema", "Entity Definitions", "i18n Translations"],
                        entities: ["ServiceEntrySheet", "ServiceEntrySheetItem"]
                    },
                    {
                        id: "supplierinvoice",
                        title: "Supplier Invoice",
                        subtitle: "Transaction Product",
                        description: "Invoice header and item definitions with variance tracking and payment status",
                        file: "sap-s4com-SupplierInvoice-v1.en.json",
                        type: "Transaction",
                        status: "Error",
                        artefacts: ["CSN Schema", "Entity Definitions", "i18n Translations", "Tax Handling"],
                        entities: ["SupplierInvoice", "SupplierInvoiceItem", "SupplierInvoiceItemPurOrdRef"]
                    },
                    {
                        id: "paymentterms",
                        title: "Payment Terms",
                        subtitle: "Master Data Product",
                        description: "Payment terms master data with discount structures",
                        file: "sap-s4com-PaymentTerms-v1.en.json",
                        type: "Master Data",
                        status: "Success",
                        artefacts: ["CSN Schema", "Entity Definitions", "i18n Translations"],
                        entities: ["PaymentTerms"]
                    }
                ];
                
                // Create Master List
                function createMasterList() {
                    return new List({
                        headerText: "Data Products ({0})".replace("{0}", dataProducts.length),
                        mode: "SingleSelectMaster",
                        items: dataProducts.map(function(product) {
                            return new ObjectListItem({
                                type: "Active",
                                title: product.title,
                                number: product.entities.length,
                                numberUnit: product.entities.length === 1 ? "Entity" : "Entities",
                                intro: product.type,
                                press: function() {
                                    showDetail(product);
                                },
                                attributes: [
                                    new ObjectAttribute({
                                        text: product.file
                                    })
                                ],
                                firstStatus: new ObjectStatus({
                                    text: product.type,
                                    state: product.type === "Master Data" ? "Information" : "Success"
                                })
                            });
                        })
                    });
                }
                
                // Create Detail Page with Object Page Layout (Fiori pattern)
                function createDetailPage(product) {
                    var headerTitle = new ObjectPageHeader({
                        objectTitle: product.title,
                        objectSubtitle: product.subtitle,
                        actions: [
                            new ObjectPageHeaderActionButton({
                                icon: "sap-icon://action",
                                text: "View File",
                                press: function() {
                                    sap.m.MessageToast.show("Opening: " + product.file);
                                }
                            }),
                            new ObjectPageHeaderActionButton({
                                icon: "sap-icon://download",
                                text: "Download",
                                press: function() {
                                    sap.m.MessageToast.show("Downloading: " + product.file);
                                }
                            })
                        ],
                        headerDesign: "Light"
                    });
                    
                    var headerContent = new ObjectPageHeaderContent({
                        content: [
                            new HBox({
                                items: [
                                    new VBox({
                                        items: [
                                            new Label({ text: "File Name" }),
                                            new Text({ text: product.file }).addStyleClass("sapUiTinyMarginTop")
                                        ]
                                    }).addStyleClass("sapUiMediumMarginEnd"),
                                    new VBox({
                                        items: [
                                            new Label({ text: "Product Type" }),
                                            new ObjectStatus({
                                                text: product.type,
                                                state: product.type === "Master Data" ? "Information" : "Success"
                                            }).addStyleClass("sapUiTinyMarginTop")
                                        ]
                                    }).addStyleClass("sapUiMediumMarginEnd"),
                                    new VBox({
                                        items: [
                                            new Label({ text: "Artefacts" }),
                                            new Text({ text: product.artefacts.length + " items" }).addStyleClass("sapUiTinyMarginTop")
                                        ]
                                    }).addStyleClass("sapUiMediumMarginEnd"),
                                    new VBox({
                                        items: [
                                            new Label({ text: "Entities" }),
                                            new Text({ text: product.entities.length + " entities" }).addStyleClass("sapUiTinyMarginTop")
                                        ]
                                    })
                                ]
                            })
                        ]
                    });
                    
                    // Overview Section
                    var overviewSection = new ObjectPageSection({
                        title: "Overview",
                        subSections: [
                            new ObjectPageSubSection({
                                title: "Description",
                                blocks: [
                                    new Text({
                                        text: product.description
                                    }).addStyleClass("sapUiSmallMarginBottom"),
                                    new MessageStrip({
                                        text: "This data product is a collection container that includes CSN schema definitions and supporting metadata within the P2P business context.",
                                        type: "Information",
                                        showIcon: true
                                    }).addStyleClass("sapUiMediumMarginTop")
                                ]
                            })
                        ]
                    });
                    
                    // Artefacts Section
                    var artefactsSection = new ObjectPageSection({
                        title: "Artefacts",
                        subSections: [
                            new ObjectPageSubSection({
                                title: "Included Artefacts",
                                blocks: [
                                    new List({
                                        items: product.artefacts.map(function(artefact) {
                                            return new StandardListItem({
                                                title: artefact,
                                                icon: "sap-icon://document",
                                                type: "Inactive"
                                            });
                                        })
                                    })
                                ]
                            })
                        ]
                    });
                    
                    // Entities Section
                    var entitiesSection = new ObjectPageSection({
                        title: "Entities",
                        subSections: [
                            new ObjectPageSubSection({
                                title: "Data Entities",
                                blocks: [
                                    new List({
                                        items: product.entities.map(function(entity) {
                                            return new StandardListItem({
                                                title: entity,
                                                description: "Entity definition in CSN format",
                                                icon: "sap-icon://table-view",
                                                type: "Navigation",
                                                press: function() {
                                                    sap.m.MessageToast.show("Viewing entity: " + entity);
                                                }
                                            });
                                        })
                                    })
                                ]
                            })
                        ]
                    });
                    
                    // Structure Section
                    var structureSection = new ObjectPageSection({
                        title: "Structure",
                        subSections: [
                            new ObjectPageSubSection({
                                title: "CSN File Structure",
                                blocks: [
                                    new Panel({
                                        headerText: "Schema Organization",
                                        content: [
                                            new HTML({
                                                content: '<pre style="background: #f7f7f7; padding: 1rem; border-radius: 0.25rem; font-family: monospace; line-height: 1.6; margin: 0;">' +
                                                    'Data Product Container\n' +
                                                    '├── CSN Schema File\n' +
                                                    '│   ├── definitions (Entities)\n' +
                                                    '│   │   ├── Entity 1\n' +
                                                    '│   │   │   ├── @EndUserText.label\n' +
                                                    '│   │   │   └── elements (Fields)\n' +
                                                    '│   │   └── Entity N...\n' +
                                                    '│   └── i18n (Translations)\n' +
                                                    '│       └── en (English)\n' +
                                                    '├── Metadata\n' +
                                                    '└── Documentation\n' +
                                                    '</pre>'
                                            })
                                        ]
                                    }).addStyleClass("sapUiNoContentPadding")
                                ]
                            })
                        ]
                    });
                    
                    return new ObjectPageLayout({
                        headerTitle: headerTitle,
                        headerContent: headerContent,
                        sections: [
                            overviewSection,
                            artefactsSection,
                            entitiesSection,
                            structureSection
                        ],
                        showTitleInHeaderContent: true,
                        alwaysShowContentHeader: false,
                        preserveHeaderStateOnScroll: false,
                        headerContentPinnable: true,
                        isChildPage: true,
                        upperCaseAnchorBar: false
                    });
                }
                
                // Create empty detail page
                function createEmptyDetailPage() {
                    return new Page({
                        title: "Data Products",
                        content: [
                            new VBox({
                                alignItems: "Center",
                                justifyContent: "Center",
                                items: [
                                    new Title({
                                        text: "Select a Data Product",
                                        level: "H2"
                                    }).addStyleClass("sapUiMediumMarginTop"),
                                    new Text({
                                        text: "Choose a data product from the list to view details"
                                    }).addStyleClass("sapUiSmallMarginTop")
                                ]
                            }).addStyleClass("sapUiContentPadding")
                        ]
                    });
                }
                
                // Create Flexible Column Layout (Fiori List-Detail pattern)
                var oFCL = new FlexibleColumnLayout({
                    layout: LayoutType.OneColumn,
                    beginColumnPages: [
                        new Page({
                            title: "Manage P2P Data Products",
                            showHeader: true,
                            subHeader: new Bar({
                                contentMiddle: [
                                    new Text({
                                        text: "Procure-to-Pay data product catalog"
                                    })
                                ]
                            }),
                            content: [
                                new MessageStrip({
                                    text: "Data Products are collection containers with CSN schemas and metadata for the P2P business domain.",
                                    type: "Information",
                                    showIcon: true
                                }).addStyleClass("sapUiSmallMarginBeginEnd sapUiSmallMarginTop"),
                                createMasterList()
                            ]
                        })
                    ],
                    midColumnPages: [
                        createEmptyDetailPage()
                    ]
                });
                
                // Show detail function
                function showDetail(product) {
                    oFCL.setLayout(LayoutType.TwoColumnsMidExpanded);
                    var detailPage = createDetailPage(product);
                    oFCL.removeAllMidColumnPages();
                    oFCL.addMidColumnPage(detailPage);
                }
                
                // Create App
                var oApp = new App({
                    pages: [oFCL]
                });
                
                // Place app in HTML
                oApp.placeAt("content");
            });
        });
    </script>
</head>
<body class="sapUiBody" id="content">
    <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">
        <p>Loading SAP Fiori Application...</p>
    </div>
</body>
</html>
